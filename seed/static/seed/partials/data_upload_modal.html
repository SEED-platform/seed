<div class="modal-header" ng-switch on="step.number">
    <h4 class="modal-title" ng-switch-when="1" translate>Create a New Data Set.</h4>
    <h4 class="modal-title" ng-switch-when="2" translate>Upload your data.</h4>
    <h4 class="modal-title" ng-switch-when="3" translate>Successful upload!</h4>
    <h4 class="modal-title" ng-switch-when="4" translate>Upload your energy data.</h4>
    <h4 class="modal-title" ng-switch-when="5" translate>Successful upload!</h4>
    <h4 class="modal-title" ng-switch-when="6" translate>What type of file would you like to upload?</h4>
    <h4 class="modal-title" ng-switch-when="7" translate>Finding inventory matches.</h4>
    <h4 class="modal-title" ng-switch-when="8">{$ 'Matching Results for file' | translate $}: <strong>{$ dataset.filename $}</strong></h4>
    <h4 class="modal-title" ng-switch-when="9">{$ 'Add files to' | translate $} {$ dataset.name $}.</h4>
    <h4 class="modal-title" ng-switch-when="10">{$ step_10_title|translate|titleCase $}</h4>
    <h4 class="modal-title" ng-switch-when="11" translate>Confirm Save Mappings?</h4>
    <h4 class="modal-title" ng-switch-when="12" translate>Error Processing Data</h4>
</div>
<div class="modal-body no_bottom_padding" ng-switch on="step.number">
    <!-- Step 1 -->
    <div class="data_upload_steps form-horizontal" ng-switch-when="1">
        <div class="alert alert-danger" ng-show="dataset.alert">
            TRANSLATION_FIXME The data set <strong>name "{$ dataset.name $}" already exists</strong>. Please select a new one.
        </div>
        <div class="form-group" ng-class="{'has-error': dataset.alert, 'has-feedback': dataset.alert}">
            <label class="control-label col-lg-3 col-sm-3" for="inputDataUploadName" translate>Data Set Name</label>
            <div class="col-lg-8 col-sm-8">
                <input type="text" class="form-control" id="inputDataUploadName" ng-model="dataset.name" placeholder="{$ 'your data set name' | translate $}" sd-enter="create_dataset(dataset.name)" required>
            </div>
        </div>
    </div>
    <!-- Step 2: Choose upload type -->
    <div class="data_upload_steps container-fluid" ng-switch-when="2">
        <div class="alert alert-danger" ng-show="uploader.invalid_extension_alert">
          TRANSLATION_FIXME
            <strong>Sorry!</strong> SEED doesn't currently support that file format. Only <strong>.csv</strong>,
            <strong>.xls</strong>, <strong>.xlsx</strong>, and <strong>.xml</strong> files are supported.
        </div>
        <div class="row">
            <div class="col-sm-10 col-sm-offset-1" ng-hide="uploader.in_progress">
                <div class="row">
                    <label class="col-sm-3 col-sm-offset-1 control-label" for="selected-cycle" style="margin-top: 5px;">{$ 'Time Period' | translate $}:</label>
                    <div class="col-sm-7">
                        <select id="selected-cycle" name="selected-cycle" class="form-control input-sm" ng-model="selectedCycle" ng-options="cycle.name for cycle in cycles track by cycle.id"></select>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-10 col-sm-offset-4">
                        <a ui-sref="organization_cycles(::{organization_id: organization.id})" ng-click="cancel()" translate>Manage available cycles.</a>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-8 col-sm-offset-2" sd-uploader sourcetype="Assessed Raw" sourceprog="" sourcever="" importrecord="dataset.id" buttontext="{$ 'Upload a Spreadsheet' | translate $}" eventfunc="uploaderfunc(message, file, progress)" ng-hide="uploader.in_progress" ng-disabled="!selectedCycle" style="padding-top: 20px;"></div>
        </div>
        <div class="row">
            <div class="col-sm-8 col-sm-offset-2" sd-uploader sourcetype="Assessed Raw" sourceprog="PortfolioManager" sourcever="1.0" importrecord="dataset.id" buttontext="{$ 'Upload Portfolio Manager Data' | translate $}" eventfunc="uploaderfunc(message, file, progress)" ng-disabled="!selectedCycle" ng-hide="uploader.in_progress"></div>
        </div>
        <div class="row">
            <div class="col-sm-9 col-sm-offset-2" ng-hide="uploader.in_progress">
                <!--<div class="row">-->
                    <!--<span class="col-xs-1"><input type="checkbox" id="use-field-option" name="pm-cycle-option" ng-model="useField" ng-init="useField = true" value="field"></span>-->
                    <!--<label class="col-sm-7 control-label" for="use-field-option" translate>Determine Time Period from Field:</label>-->
                    <!--<span class="col-sm-4" translate>Year Ending</span>-->
                <!--</div>-->
            </div>
        </div>
        <div class="row">
            <div class="col-sm-8 col-sm-offset-2 green_button" sd-uploader sourcetype="Green Button Raw" sourceprog="" sourcever="" importrecord="dataset.id" buttontext="{$ 'Upload Green Button Data' | translate $}" eventfunc="uploaderfunc(message, file, progress)" ng-hide="uploader.in_progress" ng-disabled="true" style="padding-top: 10px;" translate>Upload Green Button Data</div>
        </div>
        <div class="progress_bar_container" ng-show="uploader.in_progress">
            <div class="progress_bar_copy_top">{$ 'Uploading' | translate $} <strong>{$ dataset.filename $}</strong></div>

            <uib-progressbar class="progress-striped active" value="uploader.progress" type="success"></uib-progressbar>
            <div class="progress_bar_copy_bottom">{$ uploader.progress | number:0 $}% {$ uploader.status_message | translate $} TRANSLATION_FIXME</div>
        </div>
        <div ng-hide="uploader.in_progress" style="margin-top: 30px;">
            <div>
              TRANSLATION_FIXME
                <p>File types supported: <strong>.csv</strong>, <strong>.xls</strong>, <strong>.xlsx</strong>, and
                    <strong>.xml</strong>.</p>
                <p><strong>Note:</strong> multi-sheet Excel files are not currently supported.</p>
            </div>
        </div>
    </div>
    <!-- Step 3 -->
    <div class="data_upload_steps" ng-switch-when="3">
        <div class="row">
            <div class="alert alert-success">
                <strong>{$ dataset.filename $}</strong> {$ 'has been uploaded to' | translate $} <strong>{$ dataset.name $}</strong>.
            </div>
        </div>
    </div>
    <!-- Step 4: load Portfolio Manager report data -->
    <div class="data_upload_steps" ng-switch-when="4">
        <div class="row">
            <div class="alert alert-danger" ng-show="uploader.invalid_extension_alert">
              TRANSLATION_FIXME
                <strong>Sorry!</strong> SEED doesn't currently support that file format. Only <strong>.csv</strong>,
                <strong>.xls</strong>, <strong>.xlsx</strong>, and <strong>.xml</strong> files are supported.
            </div>
            <div class="form-group col-sm-12">
                <div sd-uploader sourcetype="Portfolio Raw" importrecord="dataset.id" buttontext="{$ 'Upload your energy data file(s)' | translate $}" eventfunc="uploaderfunc(message, file, progress)" ng-hide="uploader.in_progress"></div>
                <div class="progress_bar_container" ng-show="uploader.in_progress">
                    <div class="progress_bar_copy_top">{$ 'Uploading' | translate $} <strong>{$ dataset.filename $}</strong></div>

                    <uib-progressbar class="progress-striped active" value="uploader.progress" type="success"></uib-progressbar>
                    <div class="progress_bar_copy_bottom">{$ uploader.progress | number:0 $}% {$ uploader.status_message | translate$} TRANSLATION_FIXME</div>
                </div>
            </div>
        </div>
    </div>
    <!-- Step 5 -->
    <div class="data_upload_steps" ng-switch-when="5">
        <div class="row">
            <div class="alert alert-success" ng-show="uploader.complete">
                <strong>{$ dataset.filename $}</strong> {$ 'has been uploaded to' | translate $} <strong>{$ dataset.name $}</strong>.
            </div>
        </div>
    </div>
    <!-- Step 6 -->
    <div class="data_upload_steps" ng-switch-when="6">
        <div class="row">
            <div class="form-group col-sm-12">
                <button type="button" class="btn btn-primary" ng-click="goto_step(2)" translate>Inventory list file</button>
                <button type="button" class="btn btn-primary" ng-click="goto_step(4)" translate>Energy data file</button>
            </div>
        </div>
    </div>
    <!-- Step 7: Finding building matches -->
    <div class="data_upload_steps" ng-switch-when="7">
        <div class="row">
            <div class="form-group col-sm-12">
                <div class="progress_bar_container">
                    <div class="progress_bar_copy_top">{$ 'Finding inventory matches for' | translate $}
                        <strong>{$ dataset.filename $}</strong></div>
                    <uib-progressbar class="progress-striped active" value="uploader.progress" type="success"></uib-progressbar>
                    <div class="progress_bar_copy_bottom">{$ uploader.progress | number:0 $}% {$ 'Complete' | translate $}</div>
                </div>
            </div>
        </div>
    </div>
    <!-- Step 8: Review matches -->
    <div class="data_upload_steps" ng-switch-when="8">
        <div class="row">
            <div class="alert alert-success">
                <ul>
                    <li>{$ 'Total rows in the import file' | translate $}: {$ import_file_records|number:0 $}</li>
                    <li ng-if="unmatched_properties">{$ 'New properties' | translate $}: {$ unmatched_properties|number:0 $}</li>
                    <li ng-if="unmatched_taxlots">{$ 'New tax lots' | translate $}: {$ unmatched_taxlots|number:0 $}</li>
                    <li ng-if="matched_properties">{$ 'Merged properties' | translate $}: {$ matched_properties|number:0 $}</li>
                    <li ng-if="matched_taxlots">{$ 'Merged tax lots' | translate $}: {$ matched_taxlots|number:0 $}</li>
                    <li ng-if="duplicate_property_states">{$ 'Ignored property duplicates within the import file' | translate $}: {$ duplicate_property_states|number:0 $}</li>
                    <li ng-if="duplicate_tax_lot_states">{$ 'Ignored tax lot duplicates within the import file' | translate $}: {$ duplicate_tax_lot_states|number:0 $}</li>
                    <li ng-if="duplicates_of_existing_property_states">{$ 'Ignored duplicates of existing properties' | translate $}: {$ duplicates_of_existing_property_states|number:0 $}</li>
                    <li ng-if="duplicates_of_existing_taxlot_states">{$ 'Ignored duplicates of existing tax lots' | translate $}: {$ duplicates_of_existing_taxlot_states|number:0 $}</li>
                </ul>
            </div>
        </div>
    </div>
    <!-- Step 9: Select the type of file to upload. -->
    <div class="data_upload_steps" ng-switch-when="9">
        <div class="row">
            <div class="form-group col-sm-12">TRANSLATION_FIXME {$ 'Select the type of file(s) you would like to add to' | translate $} {$ dataset.name $}.</div>
        </div>
    </div>
    <!-- Step 10: No matches -->
    <div class="data_upload_steps" ng-switch-when="10">
        <div class="row">
            <div class="alert alert-success">
                <ul>
                    <li>{$ 'Total rows in the import file' | translate $}: {$ import_file_records|number:0 $}</li>
                    <li ng-if="unmatched_properties">{$ 'New properties' | translate $}: {$ unmatched_properties|number:0 $}</li>
                    <li ng-if="unmatched_taxlots">{$ 'New tax lots' | translate $}: {$ unmatched_taxlots|number:0 $}</li>
                    <li ng-if="matched_properties">{$ 'Merged properties' | translate $}: {$ matched_properties|number:0 $}</li>
                    <li ng-if="matched_taxlots">{$ 'Merged tax lots' | translate $}: {$ matched_taxlots|number:0 $}</li>
                    <li ng-if="duplicate_property_states">{$ 'Ignored property duplicates within the import file' | translate $}: {$ duplicate_property_states|number:0 $}</li>
                    <li ng-if="duplicate_tax_lot_states">{$ 'Ignored tax lot duplicates within the import file' | translate $}: {$ duplicate_tax_lot_states|number:0 $}</li>
                    <li ng-if="duplicates_of_existing_property_states">{$ 'Ignored duplicates of existing properties' | translate $}: {$ duplicates_of_existing_property_states|number:0 $}</li>
                    <li ng-if="duplicates_of_existing_taxlot_states">{$ 'Ignored duplicates of existing tax lots' | translate $}: {$ duplicates_of_existing_taxlot_states|number:0 $}</li>
                </ul>
            </div>
            <div class="alert alert-{$ step_10_style $}">
                <span ng-show="step_10_error_message">{$ step_10_error_message | translate$} TRANSLATION_FIXME</span>
                <span ng-hide="step_10_error_message"><strong translate>SEED could not locate any existing matches</strong>. {$ 'Would you like to add another file?' | translate $}</span>
            </div>
            <div class="form-group col-sm-12"></div>
        </div>
    </div>
    <!-- Step 11: Save Mappings Permanently  -->
    <div class="data_upload_steps" ng-switch-when="11">
        <div class="row">
            <div class="alert alert-warning" translate>Did you review your mappings? It's a good idea to double check your mappings. Once SEED matches your properties &amp; tax lots you cannot undo or edit these mappings.</div>
        </div>
    </div>
    <!-- Step 12: Error Processing Data  -->
    <div class="data_upload_steps" ng-switch-when="12">
        <div class="row">
            <div class="col-sm-12">
                <div>
                    <p translate>An error occurred while processing the file. Please ensure that your file meets the required specifications.</p>
                    <pre ng-class="{'pre-scrollable': step_12_error_message.length >= 300}" ng-show="step_12_error_message">{$ step_12_error_message | translate $}</pre>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal-footer container-fluid" ng-switch on="step.number">
    <div ng-switch-when="1">
        <div class="row text-center">
            <button type="button" class="btn btn-primary col-sm-6 center-block" ng-click="create_dataset(dataset.name)" ng-disabled="dataset.disabled()" translate>Create Data Set</button>
        </div>
    </div>
    <div ng-switch-when="2"></div>
    <div ng-switch-when="3">
        <!-- Leaving this out for now as I'm not sure we want to allow the user to do this right here.
        <button type="button" class="btn btn-default">Upload another building list file</button> -->
        <div class="row text-center">
            <button type="button" class="btn btn-primary col-sm-6 center-block" ng-click="goto_data_mapping()" translate>Continue to data mapping</button>
        </div>
    </div>
    <div ng-switch-when="4"></div>
    <div ng-switch-when="5">
        <div class="row text-center">
            <button type="button" class="btn btn-default col-sm-6" center-block ng-click="goto_step(4)" translate>Upload another energy data file</button>
        </div>
        <div class="row text-center">
            <button type="button" class="btn btn-primary col-sm-6 center-block" ng-click="goto_data_matching()" translate>Continue to data matching</button>
        </div>
    </div>
    <div ng-switch-when="7"></div>
    <div ng-switch-when="8">
        <div class="row text-center">
            <button type="button" class="btn btn-primary col-sm-6 center-block" ng-click="goto_step(2)" translate>Add another file</button>
        </div>
        <div class="row text-center">
            <button type="button" class="btn btn-primary col-sm-6 center-block" ng-click="view_my_properties()" translate>View my properties</button>
        </div>
        <div class="row text-center">
            <button id="review-mapping" type="button" class="btn btn-primary col-sm-6 center-block" ng-click="goto_data_matching()" translate>Review matches</button>
        </div>
    </div>
    <div ng-switch-when="9">
        <div class="row text-center">
            <button type="button" class="btn btn-primary col-sm-6 center-block" ng-click="goto_step(2)" translate>Add another file</button>
        </div>
    </div>
    <div ng-switch-when="10">
        <div class="row text-center">
            <button type="button" class="btn btn-primary col-sm-6 center-block" ng-click="goto_step(2)" translate>Add another file</button>
        </div>
        <div class="row text-center">
            <button id="view-buildings" type="button" class="btn btn-primary col-sm-6 center-block" ng-click="view_my_properties()" translate>View my properties</button>
        </div>
    </div>
    <div ng-switch-when="11">
        <div class="row text-center">
            <button type="button" id="confirm-mapping" class="btn btn-primary col-sm-6 center-block" ng-click="save_mappings()" translate>Confirm mappings &amp; start matching</button>
        </div>
    </div>
    <div class="row text-center">
        <button type="button" class="btn btn-default col-sm-6 center-block" ng-click="cancel()" translate>Dismiss</button>
    </div>
</div>
