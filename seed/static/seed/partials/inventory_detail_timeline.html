<div class="page_header_container" ng-cloak>
    <div class="page_header">
        <div class="left page_action_container">
            <a ui-sref="inventory_list(::{inventory_type: inventory_type})" class="page_action">
                <i class="fa fa-chevron-left"></i>
                {$:: (inventory_type === 'taxlots' ? 'Tax Lots' : 'Properties') | translate $}
            </a>
        </div>
        <div class="page_title">
            <h1>{$:: (inventory_type === 'taxlots' ? 'Tax Lot Detail' : 'Property Detail') | translate $}</h1>
        </div>
    </div>
</div>
<div class="section_nav_container">
    <div class="section_nav" ng-include="::urls.static_url + 'seed/partials/inventory_detail_nav.html'"></div>
</div>
<div class="section_header_container">
    <div class="section_header fixed_height_short has_no_padding">
        <div class="section_action_container left" style="width: 50%;">
            <span>
                <h2>
                    <span ng-if="::inventory_type==='properties'">
                        <i class="fa fa-building-o"></i><span translate>Property</span> :
                    </span>
                    <span ng-if="::inventory_type==='taxlots'">
                        <i class="fa fa-map-o"></i><span translate>Tax Lot</span> :
                    </span>
                    <span ng-bind-html="inventory_name">{$ inventory_display_name(inventory_type==='properties' ?
                        'property' : 'taxlot') | translate $}</span>
                </h2>
            </span>
        </div>
    </div>
</div>
<!-- Timeline: cycles -> events -> trigger -->
<div class="section_content_container">
    
    <div class="section">
        <!-- Cycles -->
        <table id="cycles-table">
            <tbody>
                <tr ng-repeat-start="cycle in timeline.cycles" class="cycle-row">
                    <td width="20">
                        <div ng-click="expand_cycle(cycle.id)" style="padding: 5px;">
                            <i class="fa fa-chevron-right" style="color: white;"
                                ng-class="expanded_rows['cycles'][cycle.id]['expanded'] ? 'down' : 'right'">
                            </i>
                        </div>
                    </td>
                    <td >
                        name: {$ cycle.cycle_name $}
                    </td>
                    <td>
                        events: {$ cycle.events.length $}
                    </td>
                </tr>
                <!-- Events -->
                <tr ng-repeat-end style="background: white;">
                    <td colspan="100%">
                        <table class="event-table">
                            <tbody>
                                <tr ng-repeat-start="event in cycle.events" 
                                    ng-class="expanded_rows['cycles'][cycle.id]['expanded'] ? 'show' : 'noshow'"
                                    style="background: rgb(112,113,113); border-bottom: 2px solid white;"
                                    >
                                        <td width="20">
                                            <div ng-click="expand_event(cycle.id, event.id)" style="padding: 5px;">
                                                <i class="fa fa-chevron-right" style="color: white;"
                                                    ng-class="check_expanded_events(cycle.id, event.id) ? 'down' : 'right'">
                                                </i>
                                            </div>
                                        </td>
                                        <td>
                                            event: {$ format_created(event.created) $}
                                        </td>
                                        <td>
                                            type:  {$ format_event_type(event) $}
                                        </td>
                                </tr>
                                <!-- Triggers -->
                                <tr ng-repeat-end colspan="100%" 
                                    ng-class="false ? 'show' : 'noshow'"
                                    style="background: white;"
                                    >
                                    <td ng-if="event.type == 1">
                                        <div class="event-trigger" ng-controller="event_inventory_document_controller" ng-include="::urls.static_url + 'seed/partials/event_inventory_document_card.html'"></div>
                                    </td>
                                    <td ng-if="event.type == 2">
                                        <div class="event-trigger" ng-include="::urls.static_url + 'seed/partials/event_analysis_card.html'"></div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
