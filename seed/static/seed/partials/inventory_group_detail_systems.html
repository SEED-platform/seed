<div class="page_header_container">
  <div class="page_header">
    <div class="left page_action_container">
      <a ui-sref="inventory_groups(::{inventory_type: inventory_type})" class="page_action">
        <i class="fa-solid fa-chevron-left"></i>
        {$:: 'Groups' | translate $}
      </a>
    </div>
    <div class="page_title">
      <h1>{$:: 'Group Detail' | translate $}</h1>
    </div>
    <div class="right page_action_container"></div>
  </div>
</div>
<div class="section_nav_container">
  <div class="section_nav" ng-include="::urls.static_url + 'seed/partials/inventory_group_detail_nav.html'"></div>
</div>

<button ng-show="menu.user.organization.user_role !== 'viewer'" type="button" class="col-sm-2 btn btn-info"
  ng-click="open_create_system_modal()"> New System </button>
<ul>
  <ul ng-repeat="system in systems_old">
    <div style="display:flex; gap:1rem">
      <p>{$ system.type | translate $} - {$ system.name $}</p>
      <button ng-show="menu.user.organization.user_role !== 'viewer'" type="button" class="col-sm-2 btn btn-info"
        ng-click="open_create_service_modal(system)"> New Service </button>
    </div>
    <ul>
      <li ng-repeat="service in system.services">
        {$ service.name $}
      </li>
    </ul>
  </ul>
</ul>

<div class="systems-container">
  <div class="system-table-container">
    <!-- DES SYSTEMS -->
    <div class="system-type">DES Systems</div>
    <table id="des-table" class="table table-striped table_highlight_first system-table" style="border-bottom: 1px solid #dddddd">
      <thead>
        <tr>
          <th style="width:50px;"></th>
          <th>Name</th>
          <th>Type</th>
          <th>Capacity</th>
          <th>Count</th>
        </tr>
      </thead>
      <tbody>
          <tr ng-repeat-start="system in systems.DES">
            <td><button ng-if="system.services.length" type="button" class="accordion-button" data-toggle="collapse" data-target="#collapse-{$ system.id $}" ng-click="collapse(system.id)">
              <i class="fa-solid fa-chevron-right accordion-indicator-default-closed"></i>
            </button></td>
            <td>{$ system.name $}</td>
            <td>{$ system.type $}</td>
            <td>{$ system.capacity $}</td>
            <td>{$ system.count $}</td>
          </tr>
          <tr id="collapse-{$ system.id $}" class="collapse" ng-repeat-end="system in systems.DES">
            <td></td>
            <td colspan="4"><div id="des-uigrid" ui-grid="gridOptionsBySystemId[system.id]"></div></td>
          </tr>
      </tbody>
    </table>
  </div>
  
  <!-- EVSE SYSTEMS -->
  <div class="system-table-container">
    <div class="system-type">EVSE Systems</div>
    <table id="evse-table" class="table table-striped table_highlight_first system-table" style="border-bottom: 1px solid #dddddd">
      <thead>
        <tr>
          <th style="width:50px;"></th>
          <th>Name</th>
          <th>Type</th>
          <th>Power</th>
          <th>Count</th>
        </tr>
      </thead>
      <tbody>
          <tr ng-repeat-start="system in systems.EVSE">
            <td><button ng-if="system.services.length" type="button" class="accordion-button" data-toggle="collapse" data-target="#collapse-{$ system.id $}" ng-click="collapse(system.id)">
              <i class="fa-solid fa-chevron-right accordion-indicator-default-closed"></i>
            </button></td>
            <td>{$ system.name $}</td>
            <td>{$ system.type $}</td>
            <td>{$ system.power $}</td>
            <td>{$ system.count $}</td>
          </tr>
          <tr id="collapse-{$ system.id $}" class="collapse" ng-repeat-end="system in systems.EVSE">
            <td></td>
            <td colspan="4"><div id="evse-uigrid" ui-grid="gridOptionsBySystemId[system.id]"></div></td>
          </tr>
      </tbody>
    </table>
  </div>
  
  <!-- BATTERY SYSTEMS -->
  <div class="system-table-container">
    <div class="system-type">Battery Systems</div>
    <table id="battery-table" class="table table-striped table_highlight_first system-table" style="border-bottom: 1px solid #dddddd">
      <thead>
        <tr>
          <th style="width:50px;"></th>
          <th>Name</th>
          <th>Type</th>
          <th>Capacity</th>
          <th>Voltage</th>
        </tr>
      </thead>
      <tbody>
          <tr ng-repeat-start="system in systems.Battery">
            <td><button ng-if="system.services.length" type="button" class="accordion-button" data-toggle="collapse" data-target="#collapse-{$ system.id $}" ng-click="collapse(system.id)">
              <i class="fa-solid fa-chevron-right accordion-indicator-default-closed"></i>
            </button></td>
            <td>{$ system.name $}</td>
            <td>{$ system.type $}</td>
            <td>{$ system.capacity $}</td>
            <td>{$ system.voltage $}</td>
          </tr>
          <tr id="collapse-{$ system.id $}" class="collapse" ng-repeat-end="system in systems.Battery">
            <td></td>
            <td colspan="4"><div id="battery-uigrid" ui-grid="gridOptionsBySystemId[system.id]"></div></td>
          </tr>
      </tbody>
    </table>
  </div>
  
</div>
